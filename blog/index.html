<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pgtitle">Blog - zeroxed</title>

    <link rel="stylesheet" href="../src/css/bootstrap.css">
    <link rel="stylesheet" href="def-blog.css">

    <link rel="shortcut icon" href="../src/img/pageicon.png" type="image/x-icon">

    <script src="../src/js/jquery-3.5.1.js"></script>
</head>
<body>
    <script>
        $.getJSON('../api/blog/blog.json', function(data) {
            if (!window.location.href.includes('post')) {
                document.getElementById('pgtitle').textContent = 'Blog - zeroxed'
                document.getElementById('mainonly2').style.display = 'none'
                var len = data.length
                var arr = 0
                var out = document.getElementById('blog')
                var row = document.createElement('div')
                row.className = 'row'
                while (arr < len) {
                    var c = document.createElement('div')
                    c.className = 'col-sm-6'

                    var card = document.createElement('div')
                    card.className = 'card'

                    if (data[arr].featured == true) {
                        var f = document.createElement('h6')
                        f.className = 'card-header'
                        f.textContent = 'Featured'
                        card.appendChild(f)
                        card.className += ' bg-dark text-white'
                    }

                    var body = document.createElement('div')
                    body.className = 'card-body'

                    var title = document.createElement('h5')
                    title.textContent = data[arr].title
                    title.className = 'card-title'
                    body.appendChild(title)

                    var content = document.createElement('p')
                    content.className = 'card-text'
                    content.textContent = data[arr].desc
                    body.appendChild(content)

                    var btn = document.createElement('a')
                    btn.className = 'btn btn-primary'
                    if (data[arr].btn != undefined) {
                        btn.textContent = data[arr].btn
                    }
                    else {
                        btn.textContent = 'Read more'
                    }
                    btn.href = window.location.href + '?post=' + arr
                    body.appendChild(btn)

                    var hr = document.createElement('hr')
                    body.appendChild(hr)

                    var author = document.createElement('p')
                    var a = document.createElement('small')
                    a.className = ''
                    a.innerHTML = 'Written by <code>' + data[arr].author + '</code> on <code>' + data[arr].date + '</code>'
                    author.appendChild(a)
                    body.appendChild(author)


                    card.appendChild(body)

                    c.appendChild(card)

                    row.appendChild(c)

                    out.appendChild(row)
                    arr++
                }
            }
            else if (window.location.href.includes('post')) {
                //JUST USE THE BLOG POST ARRAY NUMBER AS THE ID
                document.getElementById('mainonly').style.display = 'none'
                document.getElementById('mainonly2').style.display = 'block'

                var a = window.location.href.split('post=')
                var postid = a[1]

                document.getElementById('pgtitle').textContent = data[postid].title + ' - zeroxed Blog'

                var out = document.getElementById('blog-o')


                if (data[postid].imgurl != undefined) {
                    var img = document.createElement('img')
                    img.alt = data[postid].title
                    img.src = data[postid].imgurl
                    img.style.width = '100%'
                }

                var o = document.createElement('div')
                o.className = 'container'

                var title = document.createElement('h1')
                title.textContent = data[postid].title
                o.appendChild(title)

                var desc = document.createElement('h4')
                desc.textContent = data[postid].desc
                o.appendChild(desc)

                var info = document.createElement('p')
                info.innerHTML = 'Written by <code>' + data[postid].author + '</code> on <code>' + data[postid].date + '</code>'
                o.appendChild(info)

                var hr = document.createElement('hr')
                o.appendChild(hr)

                var c = document.createElement('p')
                var ca = data[postid].content.split('\n')
                var cb = ca.join('<br>')
                c.innerHTML = cb
                o.appendChild(c)

                var h = document.createElement('hr')
                o.appendChild(h)

                var f = document.createElement('p')
                f.className = 'text-muted'

                if (data[postid].footer != undefined) {
                    f.textContent = data[postid].footer
                }
                else {
                    f.innerHTML = '&copy; Owen M. 2020'
                }

                o.appendChild(f)

                if (data[postid].imgurl != undefined) {
                    out.appendChild(img)
                }

                out.appendChild(o)
            }
        })
    </script>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <h1 class="navbar-brand">zeroxed</h1>
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a href="../" class="nav-link">Home</a>
            </li>
            <li class="nav-item">
                <a id="mainonly2" href="../blog/" class="nav-link">Blog</a>
            </li>
        </ul>
    </nav>
    <div class="container">
        <div id="mainonly">
            <br>
            <div class="jumbotron">
                <h1><code>zeroxed</code> blog</h1>
                <p class="text-muted">Slightly professional.</p>
                <hr>
                <p>In the middle of changing my internet name to <code>zeroxed</code>.</p>
            </div>
            <hr>
        </div>
        <div id="blog"></div>
    </div>
    <div id="blog-o"></div>
    <!--
        <img src="../src/img/logobg2.png" alt="Blog post image" id="blog-img">
    <div class="container">
        <h1>Blog post title</h1>
        <h4>Some teaser?</h4>
        <p>Written by <code>hehehehe</code></p>
        <hr>
        <p>Actual blog content.</p>
    </div>
    -->
</body>
</html>